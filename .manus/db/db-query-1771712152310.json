{
  "query": "CREATE TABLE IF NOT EXISTS `ai_detection_results` (\n  `id` int AUTO_INCREMENT NOT NULL,\n  `trackId` int NOT NULL,\n  `isAiGenerated` boolean,\n  `confidenceScore` decimal(5, 2),\n  `detectedEngine` varchar(100),\n  `musicIsAi` boolean,\n  `musicConfidence` decimal(5, 2),\n  `vocalsAreAi` boolean,\n  `vocalsConfidence` decimal(5, 2),\n  `apiProvider` varchar(50) NOT NULL DEFAULT 'hive',\n  `rawResponse` json,\n  `analyzedAt` timestamp NOT NULL DEFAULT (now()),\n  `updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n  CONSTRAINT `ai_detection_results_id` PRIMARY KEY(`id`),\n  KEY `track_id_idx` (`trackId`),\n  KEY `is_ai_generated_idx` (`isAiGenerated`),\n  KEY `analyzed_at_idx` (`analyzedAt`),\n  CONSTRAINT `ai_det_track_fk` FOREIGN KEY (`trackId`) REFERENCES `bap_tracks`(`id`)\n);\n\nCREATE TABLE IF NOT EXISTS `content_moderation_queue` (\n  `id` int AUTO_INCREMENT NOT NULL,\n  `trackId` int NOT NULL,\n  `artistId` int NOT NULL,\n  `flagReason` enum('ai_detection_high_confidence','ai_detection_medium_confidence','prohibited_tool_disclosed','manual_report','copyright_claim','other') NOT NULL,\n  `flagDetails` text,\n  `aiDetectionId` int,\n  `status` enum('pending','under_review','approved','removed','appealed','appeal_approved','appeal_rejected') NOT NULL DEFAULT 'pending',\n  `reviewedBy` int,\n  `reviewNotes` text,\n  `reviewedAt` timestamp,\n  `strikeIssued` boolean NOT NULL DEFAULT false,\n  `strikeNumber` int,\n  `flaggedAt` timestamp NOT NULL DEFAULT (now()),\n  `updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n  CONSTRAINT `content_moderation_queue_id` PRIMARY KEY(`id`),\n  KEY `cmq_track_idx` (`trackId`),\n  KEY `cmq_artist_idx` (`artistId`),\n  KEY `cmq_status_idx` (`status`),\n  KEY `cmq_flagged_idx` (`flaggedAt`),\n  CONSTRAINT `cmq_track_fk` FOREIGN KEY (`trackId`) REFERENCES `bap_tracks`(`id`),\n  CONSTRAINT `cmq_artist_fk` FOREIGN KEY (`artistId`) REFERENCES `artist_profiles`(`id`),\n  CONSTRAINT `cmq_ai_det_fk` FOREIGN KEY (`aiDetectionId`) REFERENCES `ai_detection_results`(`id`),\n  CONSTRAINT `cmq_reviewer_fk` FOREIGN KEY (`reviewedBy`) REFERENCES `users`(`id`)\n);\n\nCREATE TABLE IF NOT EXISTS `artist_strike_history` (\n  `id` int AUTO_INCREMENT NOT NULL,\n  `artistId` int NOT NULL,\n  `strikeNumber` int NOT NULL,\n  `reason` text NOT NULL,\n  `trackId` int,\n  `moderationQueueId` int,\n  `penalty` enum('warning','suspension','permanent_ban') NOT NULL,\n  `suspensionEndsAt` timestamp,\n  `issuedBy` int NOT NULL,\n  `issuedAt` timestamp NOT NULL DEFAULT (now()),\n  `appealStatus` enum('none','pending','approved','rejected') NOT NULL DEFAULT 'none',\n  `appealReason` text,\n  `appealedAt` timestamp,\n  `appealReviewedBy` int,\n  `appealReviewedAt` timestamp,\n  `appealNotes` text,\n  `createdAt` timestamp NOT NULL DEFAULT (now()),\n  `updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n  CONSTRAINT `artist_strike_history_id` PRIMARY KEY(`id`),\n  KEY `ash_artist_idx` (`artistId`),\n  KEY `ash_strike_idx` (`strikeNumber`),\n  KEY `ash_issued_idx` (`issuedAt`),\n  CONSTRAINT `ash_artist_fk` FOREIGN KEY (`artistId`) REFERENCES `artist_profiles`(`id`),\n  CONSTRAINT `ash_track_fk` FOREIGN KEY (`trackId`) REFERENCES `bap_tracks`(`id`),\n  CONSTRAINT `ash_cmq_fk` FOREIGN KEY (`moderationQueueId`) REFERENCES `content_moderation_queue`(`id`),\n  CONSTRAINT `ash_issuer_fk` FOREIGN KEY (`issuedBy`) REFERENCES `users`(`id`),\n  CONSTRAINT `ash_reviewer_fk` FOREIGN KEY (`appealReviewedBy`) REFERENCES `users`(`id`)\n);",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 2SKEMaxYovcAzrR.root --database nTbKjjzazhRpeJn9kKuXdQ --execute CREATE TABLE IF NOT EXISTS `ai_detection_results` (\n  `id` int AUTO_INCREMENT NOT NULL,\n  `trackId` int NOT NULL,\n  `isAiGenerated` boolean,\n  `confidenceScore` decimal(5, 2),\n  `detectedEngine` varchar(100),\n  `musicIsAi` boolean,\n  `musicConfidence` decimal(5, 2),\n  `vocalsAreAi` boolean,\n  `vocalsConfidence` decimal(5, 2),\n  `apiProvider` varchar(50) NOT NULL DEFAULT 'hive',\n  `rawResponse` json,\n  `analyzedAt` timestamp NOT NULL DEFAULT (now()),\n  `updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n  CONSTRAINT `ai_detection_results_id` PRIMARY KEY(`id`),\n  KEY `track_id_idx` (`trackId`),\n  KEY `is_ai_generated_idx` (`isAiGenerated`),\n  KEY `analyzed_at_idx` (`analyzedAt`),\n  CONSTRAINT `ai_det_track_fk` FOREIGN KEY (`trackId`) REFERENCES `bap_tracks`(`id`)\n);\n\nCREATE TABLE IF NOT EXISTS `content_moderation_queue` (\n  `id` int AUTO_INCREMENT NOT NULL,\n  `trackId` int NOT NULL,\n  `artistId` int NOT NULL,\n  `flagReason` enum('ai_detection_high_confidence','ai_detection_medium_confidence','prohibited_tool_disclosed','manual_report','copyright_claim','other') NOT NULL,\n  `flagDetails` text,\n  `aiDetectionId` int,\n  `status` enum('pending','under_review','approved','removed','appealed','appeal_approved','appeal_rejected') NOT NULL DEFAULT 'pending',\n  `reviewedBy` int,\n  `reviewNotes` text,\n  `reviewedAt` timestamp,\n  `strikeIssued` boolean NOT NULL DEFAULT false,\n  `strikeNumber` int,\n  `flaggedAt` timestamp NOT NULL DEFAULT (now()),\n  `updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n  CONSTRAINT `content_moderation_queue_id` PRIMARY KEY(`id`),\n  KEY `cmq_track_idx` (`trackId`),\n  KEY `cmq_artist_idx` (`artistId`),\n  KEY `cmq_status_idx` (`status`),\n  KEY `cmq_flagged_idx` (`flaggedAt`),\n  CONSTRAINT `cmq_track_fk` FOREIGN KEY (`trackId`) REFERENCES `bap_tracks`(`id`),\n  CONSTRAINT `cmq_artist_fk` FOREIGN KEY (`artistId`) REFERENCES `artist_profiles`(`id`),\n  CONSTRAINT `cmq_ai_det_fk` FOREIGN KEY (`aiDetectionId`) REFERENCES `ai_detection_results`(`id`),\n  CONSTRAINT `cmq_reviewer_fk` FOREIGN KEY (`reviewedBy`) REFERENCES `users`(`id`)\n);\n\nCREATE TABLE IF NOT EXISTS `artist_strike_history` (\n  `id` int AUTO_INCREMENT NOT NULL,\n  `artistId` int NOT NULL,\n  `strikeNumber` int NOT NULL,\n  `reason` text NOT NULL,\n  `trackId` int,\n  `moderationQueueId` int,\n  `penalty` enum('warning','suspension','permanent_ban') NOT NULL,\n  `suspensionEndsAt` timestamp,\n  `issuedBy` int NOT NULL,\n  `issuedAt` timestamp NOT NULL DEFAULT (now()),\n  `appealStatus` enum('none','pending','approved','rejected') NOT NULL DEFAULT 'none',\n  `appealReason` text,\n  `appealedAt` timestamp,\n  `appealReviewedBy` int,\n  `appealReviewedAt` timestamp,\n  `appealNotes` text,\n  `createdAt` timestamp NOT NULL DEFAULT (now()),\n  `updatedAt` timestamp NOT NULL DEFAULT (now()) ON UPDATE CURRENT_TIMESTAMP,\n  CONSTRAINT `artist_strike_history_id` PRIMARY KEY(`id`),\n  KEY `ash_artist_idx` (`artistId`),\n  KEY `ash_strike_idx` (`strikeNumber`),\n  KEY `ash_issued_idx` (`issuedAt`),\n  CONSTRAINT `ash_artist_fk` FOREIGN KEY (`artistId`) REFERENCES `artist_profiles`(`id`),\n  CONSTRAINT `ash_track_fk` FOREIGN KEY (`trackId`) REFERENCES `bap_tracks`(`id`),\n  CONSTRAINT `ash_cmq_fk` FOREIGN KEY (`moderationQueueId`) REFERENCES `content_moderation_queue`(`id`),\n  CONSTRAINT `ash_issuer_fk` FOREIGN KEY (`issuedBy`) REFERENCES `users`(`id`),\n  CONSTRAINT `ash_reviewer_fk` FOREIGN KEY (`appealReviewedBy`) REFERENCES `users`(`id`)\n);",
  "rows": [],
  "messages": [],
  "stdout": "",
  "stderr": "",
  "execution_time_ms": 509
}