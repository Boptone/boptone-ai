{
  "query": "CREATE TABLE IF NOT EXISTS writer_profiles (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  userId INT,\n  fullName VARCHAR(255) NOT NULL,\n  email VARCHAR(320) NOT NULL UNIQUE,\n  ipiNumber VARCHAR(20),\n  proAffiliation VARCHAR(100),\n  taxCountry VARCHAR(2),\n  taxId VARCHAR(50),\n  taxFormType ENUM('w9', 'w8ben', 'none') DEFAULT 'none',\n  taxFormUrl TEXT,\n  taxFormSubmittedAt TIMESTAMP NULL,\n  status ENUM('invited', 'pending_verification', 'active', 'suspended') DEFAULT 'invited' NOT NULL,\n  verifiedAt TIMESTAMP NULL,\n  metadata JSON,\n  createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (userId) REFERENCES users(id),\n  INDEX email_idx (email),\n  INDEX user_id_idx (userId)\n);\n\nCREATE TABLE IF NOT EXISTS writer_payment_methods (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  writerProfileId INT NOT NULL,\n  type ENUM('bank_account', 'paypal', 'venmo', 'zelle', 'crypto') NOT NULL,\n  bankName VARCHAR(255),\n  bankAccountType ENUM('checking', 'savings'),\n  bankRoutingNumber VARCHAR(20),\n  bankAccountNumber VARCHAR(50),\n  paypalEmail VARCHAR(320),\n  venmoHandle VARCHAR(100),\n  zelleEmail VARCHAR(320),\n  cryptoWalletAddress VARCHAR(255),\n  cryptoCurrency VARCHAR(20),\n  isVerified BOOLEAN DEFAULT FALSE NOT NULL,\n  verifiedAt TIMESTAMP NULL,\n  isDefault BOOLEAN DEFAULT FALSE NOT NULL,\n  status ENUM('pending', 'active', 'failed', 'disabled') DEFAULT 'pending' NOT NULL,\n  createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (writerProfileId) REFERENCES writer_profiles(id),\n  INDEX writer_profile_idx (writerProfileId)\n);\n\nCREATE TABLE IF NOT EXISTS writer_invitations (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  email VARCHAR(320) NOT NULL,\n  fullName VARCHAR(255) NOT NULL,\n  invitedByArtistId INT NOT NULL,\n  trackId INT,\n  splitPercentage DECIMAL(5, 2) NOT NULL,\n  inviteToken VARCHAR(64) NOT NULL UNIQUE,\n  expiresAt TIMESTAMP NOT NULL,\n  status ENUM('pending', 'accepted', 'expired', 'cancelled') DEFAULT 'pending' NOT NULL,\n  acceptedAt TIMESTAMP NULL,\n  writerProfileId INT,\n  createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (invitedByArtistId) REFERENCES artist_profiles(id),\n  FOREIGN KEY (trackId) REFERENCES bap_tracks(id),\n  FOREIGN KEY (writerProfileId) REFERENCES writer_profiles(id),\n  INDEX email_idx (email),\n  INDEX invite_token_idx (inviteToken),\n  INDEX track_id_idx (trackId)\n);\n\nCREATE TABLE IF NOT EXISTS writer_earnings (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  writerProfileId INT NOT NULL,\n  trackId INT NOT NULL,\n  splitPercentage DECIMAL(5, 2) NOT NULL,\n  totalEarned INT DEFAULT 0 NOT NULL,\n  pendingPayout INT DEFAULT 0 NOT NULL,\n  totalPaidOut INT DEFAULT 0 NOT NULL,\n  lastPayoutAt TIMESTAMP NULL,\n  lastPayoutAmount INT,\n  metadata JSON,\n  createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (writerProfileId) REFERENCES writer_profiles(id),\n  FOREIGN KEY (trackId) REFERENCES bap_tracks(id),\n  INDEX writer_track_idx (writerProfileId, trackId),\n  INDEX writer_profile_idx (writerProfileId),\n  INDEX track_id_idx (trackId)\n);\n\nCREATE TABLE IF NOT EXISTS writer_payouts (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  writerProfileId INT NOT NULL,\n  paymentMethodId INT NOT NULL,\n  amount INT NOT NULL,\n  currency VARCHAR(3) DEFAULT 'USD' NOT NULL,\n  trackIds JSON,\n  status ENUM('pending', 'processing', 'completed', 'failed', 'cancelled') DEFAULT 'pending' NOT NULL,\n  paymentProcessor VARCHAR(50),\n  externalPaymentId VARCHAR(255),\n  failureReason TEXT,\n  retryCount INT DEFAULT 0 NOT NULL,\n  scheduledFor TIMESTAMP NULL,\n  processedAt TIMESTAMP NULL,\n  completedAt TIMESTAMP NULL,\n  metadata JSON,\n  createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (writerProfileId) REFERENCES writer_profiles(id),\n  FOREIGN KEY (paymentMethodId) REFERENCES writer_payment_methods(id),\n  INDEX writer_profile_idx (writerProfileId),\n  INDEX status_idx (status),\n  INDEX scheduled_for_idx (scheduledFor)\n);",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 2SKEMaxYovcAzrR.root --database nTbKjjzazhRpeJn9kKuXdQ --execute CREATE TABLE IF NOT EXISTS writer_profiles (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  userId INT,\n  fullName VARCHAR(255) NOT NULL,\n  email VARCHAR(320) NOT NULL UNIQUE,\n  ipiNumber VARCHAR(20),\n  proAffiliation VARCHAR(100),\n  taxCountry VARCHAR(2),\n  taxId VARCHAR(50),\n  taxFormType ENUM('w9', 'w8ben', 'none') DEFAULT 'none',\n  taxFormUrl TEXT,\n  taxFormSubmittedAt TIMESTAMP NULL,\n  status ENUM('invited', 'pending_verification', 'active', 'suspended') DEFAULT 'invited' NOT NULL,\n  verifiedAt TIMESTAMP NULL,\n  metadata JSON,\n  createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (userId) REFERENCES users(id),\n  INDEX email_idx (email),\n  INDEX user_id_idx (userId)\n);\n\nCREATE TABLE IF NOT EXISTS writer_payment_methods (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  writerProfileId INT NOT NULL,\n  type ENUM('bank_account', 'paypal', 'venmo', 'zelle', 'crypto') NOT NULL,\n  bankName VARCHAR(255),\n  bankAccountType ENUM('checking', 'savings'),\n  bankRoutingNumber VARCHAR(20),\n  bankAccountNumber VARCHAR(50),\n  paypalEmail VARCHAR(320),\n  venmoHandle VARCHAR(100),\n  zelleEmail VARCHAR(320),\n  cryptoWalletAddress VARCHAR(255),\n  cryptoCurrency VARCHAR(20),\n  isVerified BOOLEAN DEFAULT FALSE NOT NULL,\n  verifiedAt TIMESTAMP NULL,\n  isDefault BOOLEAN DEFAULT FALSE NOT NULL,\n  status ENUM('pending', 'active', 'failed', 'disabled') DEFAULT 'pending' NOT NULL,\n  createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (writerProfileId) REFERENCES writer_profiles(id),\n  INDEX writer_profile_idx (writerProfileId)\n);\n\nCREATE TABLE IF NOT EXISTS writer_invitations (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  email VARCHAR(320) NOT NULL,\n  fullName VARCHAR(255) NOT NULL,\n  invitedByArtistId INT NOT NULL,\n  trackId INT,\n  splitPercentage DECIMAL(5, 2) NOT NULL,\n  inviteToken VARCHAR(64) NOT NULL UNIQUE,\n  expiresAt TIMESTAMP NOT NULL,\n  status ENUM('pending', 'accepted', 'expired', 'cancelled') DEFAULT 'pending' NOT NULL,\n  acceptedAt TIMESTAMP NULL,\n  writerProfileId INT,\n  createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (invitedByArtistId) REFERENCES artist_profiles(id),\n  FOREIGN KEY (trackId) REFERENCES bap_tracks(id),\n  FOREIGN KEY (writerProfileId) REFERENCES writer_profiles(id),\n  INDEX email_idx (email),\n  INDEX invite_token_idx (inviteToken),\n  INDEX track_id_idx (trackId)\n);\n\nCREATE TABLE IF NOT EXISTS writer_earnings (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  writerProfileId INT NOT NULL,\n  trackId INT NOT NULL,\n  splitPercentage DECIMAL(5, 2) NOT NULL,\n  totalEarned INT DEFAULT 0 NOT NULL,\n  pendingPayout INT DEFAULT 0 NOT NULL,\n  totalPaidOut INT DEFAULT 0 NOT NULL,\n  lastPayoutAt TIMESTAMP NULL,\n  lastPayoutAmount INT,\n  metadata JSON,\n  createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (writerProfileId) REFERENCES writer_profiles(id),\n  FOREIGN KEY (trackId) REFERENCES bap_tracks(id),\n  INDEX writer_track_idx (writerProfileId, trackId),\n  INDEX writer_profile_idx (writerProfileId),\n  INDEX track_id_idx (trackId)\n);\n\nCREATE TABLE IF NOT EXISTS writer_payouts (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  writerProfileId INT NOT NULL,\n  paymentMethodId INT NOT NULL,\n  amount INT NOT NULL,\n  currency VARCHAR(3) DEFAULT 'USD' NOT NULL,\n  trackIds JSON,\n  status ENUM('pending', 'processing', 'completed', 'failed', 'cancelled') DEFAULT 'pending' NOT NULL,\n  paymentProcessor VARCHAR(50),\n  externalPaymentId VARCHAR(255),\n  failureReason TEXT,\n  retryCount INT DEFAULT 0 NOT NULL,\n  scheduledFor TIMESTAMP NULL,\n  processedAt TIMESTAMP NULL,\n  completedAt TIMESTAMP NULL,\n  metadata JSON,\n  createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (writerProfileId) REFERENCES writer_profiles(id),\n  FOREIGN KEY (paymentMethodId) REFERENCES writer_payment_methods(id),\n  INDEX writer_profile_idx (writerProfileId),\n  INDEX status_idx (status),\n  INDEX scheduled_for_idx (scheduledFor)\n);",
  "returncode": 1,
  "logs": [
    "ERROR 1824 (HY000) at line 46: Failed to open the referenced table 'bap_tracks'"
  ]
}